// Game.cpp

#include "MyDirectX.h"
#include <sstream>

using namespace std;

const string APPTITLE = "Space Traveler";
const int SCREENW = 800;
const int SCREENH = 600;

//settings for the scroller
const int TILEWIDTH = 32;
const int TILEHEIGHT = 32;
const int MAPWIDTH = 141;
const int MAPHEIGHT = 89;

//scrolling window size
const int WINDOWWIDTH = (SCREENW / TILEWIDTH) * TILEWIDTH;
const int WINDOWHEIGHT = (SCREENH / TILEHEIGHT) * TILEHEIGHT;

int ScrollX, ScrollY;	
int SpeedX, SpeedY;					
long start;
LPDIRECT3DSURFACE9 scrollbuffer=NULL;
LPDIRECT3DSURFACE9 tiles=NULL;

int MAPDATA[MAPWIDTH*MAPHEIGHT] = { 
	188,100,151,217,311,12,111,69,150,151,302,219,58,139,307,260,310,107,106,58,93,184,185,98,217,192,275,230,95,67,222,148,32,295,92,62,194,76,137,231,172,308,56,60,30,145,142,194,156,106,61,272,118,13,187,154,144,157,276,140,56,198,229,64,270,146,190,74,75,71,230,274,72,144,28,183,62,235,19,103,253,144,13,172,262,313,74,308,98,296,262,192,259,213,106,108,311,192,116,277,224,55,272,255,93,32,228,216,176,292,22,20,305,302,262,106,238,71,62,175,66,261,23,16,14,178,259,297,110,172,98,33,61,20,13,145,59,186,253,261,13,
134,109,20,261,143,277,273,69,273,106,111,58,298,65,222,72,296,74,140,232,104,274,104,255,214,262,175,232,217,229,316,269,100,156,57,16,214,143,16,137,299,253,105,106,137,52,56,114,254,191,155,156,236,157,23,235,258,56,185,276,107,101,273,116,102,53,73,132,68,158,157,107,94,112,134,260,139,269,297,192,52,312,226,262,235,298,63,299,226,317,23,301,293,29,188,146,146,198,36,25,297,221,215,53,16,238,221,278,253,253,261,265,20,174,112,300,96,58,272,181,150,19,75,315,110,230,301,64,155,180,252,298,262,12,298,269,18,274,303,68,177,
70,157,175,238,108,152,184,255,219,185,278,115,217,219,261,56,194,189,218,52,306,266,177,318,74,29,70,53,255,178,58,298,141,318,234,109,108,55,52,218,155,238,112,145,20,135,305,31,23,151,136,145,13,175,23,109,269,238,309,37,21,146,262,198,134,158,106,155,265,75,253,13,78,57,183,55,111,196,147,224,29,299,38,172,101,18,67,275,17,75,269,12,149,68,98,140,141,21,105,263,303,113,198,306,72,297,134,236,54,113,64,22,99,309,226,177,151,52,254,101,29,197,312,59,74,310,172,225,55,257,222,218,140,275,95,92,116,36,15,254,295,
33,193,268,65,180,57,152,265,92,228,194,71,191,309,136,214,255,182,269,154,12,230,55,271,185,197,218,297,104,62,38,141,94,302,269,148,115,154,27,150,317,300,95,272,14,146,117,59,27,187,309,262,157,26,30,149,185,59,277,151,172,57,137,180,294,312,142,118,137,32,95,152,102,66,27,139,102,157,100,110,73,253,112,188,216,60,69,12,198,93,96,180,32,157,75,300,317,230,224,31,66,15,177,255,104,102,226,73,78,318,103,28,66,65,262,150,34,60,193,135,222,264,114,34,274,186,230,135,61,26,233,143,107,104,140,196,259,134,71,277,311,
193,264,141,313,301,14,275,117,13,188,108,144,29,213,13,149,296,114,18,253,75,13,194,110,67,255,147,191,108,258,56,52,155,60,197,72,115,155,72,108,108,24,304,109,58,266,99,219,187,191,194,101,236,102,26,15,19,108,77,255,56,272,115,141,73,180,215,69,69,268,70,33,293,219,252,57,313,13,194,66,217,57,175,31,111,21,267,62,178,135,195,198,106,229,255,71,266,230,317,298,237,111,269,224,173,179,38,22,236,226,174,225,102,70,63,15,303,155,233,216,230,102,268,234,225,101,230,238,192,255,22,141,217,278,19,65,188,185,153,259,62,
153,102,305,117,197,56,112,216,146,233,139,111,180,277,227,63,175,103,134,178,116,62,276,270,305,97,34,226,182,215,109,156,117,102,102,38,254,65,38,153,278,58,71,112,221,274,172,272,305,267,226,195,75,154,30,65,274,300,294,186,132,189,261,63,98,137,226,176,157,318,267,191,135,72,92,94,198,254,259,56,270,304,154,252,214,14,262,156,219,237,154,305,101,21,28,104,196,271,31,305,62,185,253,78,181,274,195,96,261,19,142,64,132,270,195,136,12,35,31,178,148,105,224,292,96,76,56,149,294,182,95,37,95,70,266,106,55,265,317,155,232,
277,94,146,175,111,151,311,308,312,213,28,228,216,68,61,227,19,222,237,226,309,76,182,252,292,72,257,68,272,144,234,100,94,107,258,230,188,141,108,20,16,312,60,76,26,114,19,69,65,104,193,311,221,101,277,27,98,27,318,313,63,214,316,73,106,226,107,147,298,273,143,311,34,232,230,147,266,302,272,176,115,193,270,105,34,111,34,212,318,318,15,299,188,23,190,144,317,56,275,224,185,177,105,141,218,316,184,186,300,74,238,260,188,181,256,273,19,31,183,98,305,272,276,110,221,154,218,32,306,297,138,179,53,226,262,192,53,216,213,144,148,
143,258,253,172,58,145,114,294,19,100,266,254,315,12,98,216,25,97,253,110,297,154,141,302,217,175,100,143,228,186,317,78,277,68,36,32,12,316,113,133,137,25,186,132,218,140,27,152,194,76,257,99,182,212,92,30,93,135,298,110,75,138,220,313,176,297,12,318,214,113,106,77,135,106,135,234,117,20,315,96,299,311,33,98,104,155,185,175,16,92,78,73,13,15,294,99,262,261,254,68,273,191,59,266,95,69,111,178,269,313,313,136,92,144,188,31,64,176,92,176,65,108,306,60,107,155,295,138,183,72,145,276,188,263,295,151,257,180,60,16,15,
155,31,105,178,237,31,253,307,216,220,260,187,176,257,71,102,103,100,197,64,146,194,36,16,192,228,158,198,235,141,267,92,34,101,270,318,143,53,273,305,70,315,140,185,314,256,56,55,181,301,237,298,62,16,134,266,136,158,149,293,216,312,318,69,105,198,268,57,106,113,314,256,187,113,298,234,212,77,218,100,316,71,295,313,196,65,230,30,190,297,225,32,190,145,26,223,32,306,179,106,146,217,96,227,275,63,98,300,308,303,231,197,134,317,143,143,218,292,197,263,28,64,158,227,109,263,70,312,141,118,308,116,270,60,23,179,265,76,230,92,184,
309,17,99,64,215,260,73,36,315,214,73,27,267,227,259,71,69,54,192,146,150,35,313,261,303,274,26,182,155,141,116,20,109,112,232,174,238,257,116,278,180,53,300,196,27,257,179,74,198,78,294,308,197,217,134,294,227,226,310,263,306,265,233,75,309,135,68,102,58,116,225,225,228,315,53,277,25,263,298,179,256,227,265,142,234,102,262,238,192,105,215,69,172,132,73,30,300,183,273,226,25,95,53,181,133,223,217,220,225,134,227,71,218,181,133,266,226,298,301,292,151,179,92,261,138,106,175,252,52,143,191,116,132,260,297,153,215,176,226,103,15,
33,157,96,222,15,295,77,147,115,58,54,142,104,62,26,236,147,24,260,262,112,234,256,33,54,308,232,33,312,174,58,219,315,148,222,257,295,259,95,195,143,137,56,15,152,172,29,316,64,182,95,220,318,184,194,316,293,264,186,222,132,68,156,265,306,269,220,175,232,74,311,144,20,108,61,260,198,233,235,56,221,302,21,213,267,181,32,23,194,276,252,177,157,14,238,144,37,147,158,22,12,309,218,17,35,228,78,110,228,185,306,179,260,78,21,298,298,157,144,194,25,318,235,38,299,78,31,219,135,152,256,102,63,76,307,174,138,263,14,261,255,
150,278,70,222,61,268,188,229,294,95,141,156,292,93,38,271,106,77,273,198,67,179,109,224,74,150,60,269,189,255,70,18,186,141,195,74,137,272,54,93,28,52,195,113,140,217,56,56,185,76,141,26,28,57,147,25,227,59,270,117,310,190,276,273,100,303,260,273,115,142,303,220,19,72,312,151,307,301,176,155,310,185,172,15,73,311,299,216,191,275,75,154,232,177,112,317,224,132,304,156,266,183,224,223,318,135,187,271,152,21,74,212,184,97,34,198,183,222,57,102,218,311,63,105,17,312,132,136,193,257,307,20,58,68,154,71,214,316,65,155,269,
30,64,276,93,193,104,146,228,65,19,257,318,31,143,237,116,305,61,184,222,182,233,24,103,190,311,15,317,19,148,34,138,54,217,301,104,223,183,138,154,58,272,99,29,20,192,147,303,197,213,223,27,196,36,308,305,219,223,61,181,185,238,105,21,198,141,97,93,218,57,103,76,186,314,59,155,113,32,105,299,267,260,197,313,225,54,66,73,230,140,60,292,236,318,64,172,38,117,305,118,108,22,27,16,179,147,217,24,137,59,116,117,304,223,74,95,66,16,221,12,213,12,118,18,112,74,192,36,257,94,277,55,308,105,214,74,275,149,220,317,263,
197,146,301,196,59,229,259,18,304,309,140,223,16,186,226,226,78,258,54,315,266,153,173,114,301,274,32,190,148,143,116,220,135,297,106,17,58,253,190,134,112,277,255,257,25,154,66,112,187,150,177,158,141,178,309,29,293,137,183,66,75,316,189,61,229,314,36,229,224,73,217,237,118,143,235,58,297,261,115,307,312,12,255,132,58,65,22,314,66,110,13,190,97,147,265,12,99,140,300,100,273,188,64,157,313,256,21,296,173,139,29,140,30,237,226,297,307,186,33,312,174,150,196,258,218,223,55,155,112,108,28,20,154,32,28,313,75,311,275,302,301,
36,175,75,73,100,228,235,109,216,60,147,76,142,174,252,116,311,259,76,156,145,99,186,189,16,314,16,153,156,178,53,156,236,297,144,307,115,21,294,116,213,148,278,115,151,195,227,238,274,299,158,191,185,310,70,268,26,266,28,297,20,257,23,92,38,259,315,139,266,12,33,65,262,94,216,143,29,150,312,109,294,309,188,277,193,238,59,184,191,308,77,301,254,143,230,271,69,68,254,261,183,227,75,36,313,306,60,236,64,12,100,318,98,315,135,136,137,149,179,228,189,99,96,173,215,133,32,295,21,38,31,295,261,295,68,265,32,110,100,276,36,
305,158,197,70,153,93,302,134,213,231,263,97,134,311,22,261,190,61,56,70,258,172,116,117,186,117,155,178,189,143,36,34,267,221,69,316,23,236,229,157,64,178,12,37,140,177,139,272,273,212,217,59,109,108,25,150,186,21,215,58,145,53,156,172,192,176,276,156,179,18,188,257,214,158,193,232,191,234,93,74,93,69,222,117,17,224,103,116,314,55,275,20,295,264,304,67,299,16,138,147,318,273,185,134,64,294,140,75,266,71,137,68,314,274,56,194,54,275,101,312,252,175,180,138,38,113,54,253,52,14,37,70,37,221,256,96,238,158,174,172,20,
315,190,21,228,272,301,38,183,98,142,26,184,175,295,264,238,198,296,101,195,295,178,105,13,56,27,21,140,219,237,146,144,198,294,101,37,145,149,304,14,70,303,118,37,72,147,177,221,195,264,297,152,69,217,148,177,29,63,143,180,150,302,26,176,20,213,178,195,190,95,150,258,66,273,271,25,156,196,62,19,232,185,29,252,117,230,175,258,146,52,93,190,144,98,269,176,110,234,217,67,74,230,103,231,60,96,150,100,118,110,173,294,97,60,142,269,194,178,195,234,116,153,304,156,223,253,303,193,140,29,214,316,78,155,272,266,102,154,110,304,313,
112,301,172,105,27,312,92,54,21,116,71,95,23,224,15,110,28,307,223,30,302,176,218,97,37,184,257,262,265,216,183,292,230,227,114,229,155,179,109,66,223,36,304,63,273,52,108,15,185,19,135,34,177,133,95,138,24,158,238,293,274,28,149,109,228,182,93,276,142,310,227,221,57,106,98,313,100,266,104,110,18,275,34,93,56,176,255,133,94,53,237,190,108,28,216,237,12,180,272,189,17,307,222,152,158,261,58,185,258,142,293,78,215,112,198,259,27,296,113,62,266,274,268,180,38,172,76,108,34,226,176,305,134,271,25,154,154,265,226,115,73,
231,139,227,197,26,238,312,315,113,217,137,144,305,312,303,191,213,212,197,235,261,78,231,26,52,272,292,23,56,135,102,146,230,14,26,260,36,222,191,314,104,75,256,106,30,312,276,215,54,308,274,259,110,156,144,296,152,37,276,303,100,278,316,193,312,104,141,311,78,153,266,17,16,146,138,112,149,29,156,53,193,107,136,118,52,318,106,118,276,196,114,133,63,265,262,191,195,62,221,296,77,292,225,33,116,180,52,196,36,70,265,293,271,258,185,60,214,219,111,94,100,185,175,180,271,58,28,99,223,185,252,315,113,58,315,52,103,179,71,296,293,
225,77,304,221,30,97,98,216,191,272,309,185,25,132,298,271,212,304,152,180,313,237,256,172,269,299,215,303,315,257,156,92,221,268,55,13,217,253,214,268,104,21,13,16,226,220,264,152,30,180,55,144,149,146,234,313,313,259,132,144,132,306,314,267,227,227,197,178,107,69,100,275,19,273,219,304,155,18,67,53,256,316,155,27,152,195,158,270,233,178,24,33,228,232,156,307,138,266,12,148,302,99,60,185,309,293,231,151,106,152,37,314,276,312,155,141,266,20,301,306,36,155,215,176,237,294,22,275,31,35,269,198,152,118,132,108,293,175,29,100,176,
142,183,274,76,92,92,172,292,184,193,277,314,145,16,277,72,258,175,269,257,152,307,270,73,36,72,61,149,259,253,93,212,275,263,56,29,25,55,195,143,23,38,157,175,151,231,149,63,59,262,265,23,175,309,57,233,69,312,21,196,254,223,253,310,178,175,77,28,266,148,196,92,53,70,238,187,218,38,99,276,172,33,256,19,75,315,99,68,187,261,17,236,192,303,107,55,267,177,179,100,177,154,271,195,22,16,252,308,110,99,197,34,265,77,292,264,152,301,318,138,56,298,149,223,101,106,230,198,145,31,183,266,156,272,76,22,195,186,217,299,72,
69,256,197,140,52,178,56,188,114,181,134,278,177,24,150,156,151,235,35,177,147,221,71,310,21,298,214,149,18,269,61,70,195,29,12,191,146,64,14,188,57,55,154,272,306,93,221,311,180,222,235,54,155,262,274,257,263,273,298,195,96,63,59,54,172,73,27,13,182,52,194,148,311,231,99,114,144,69,234,186,223,12,96,215,271,310,176,30,303,111,175,262,61,256,193,265,62,32,196,265,137,232,230,103,228,93,266,178,317,228,217,136,25,217,313,28,146,311,113,256,173,62,98,26,198,186,92,75,187,183,177,292,22,138,137,32,145,263,38,58,155,
136,261,216,66,269,188,315,309,96,232,14,68,308,296,185,188,74,191,269,182,77,62,17,237,197,27,35,305,155,180,263,156,134,179,174,34,304,153,257,99,231,277,148,143,219,317,135,136,38,25,156,260,310,134,276,174,106,67,265,252,179,312,69,260,191,73,19,306,221,66,216,267,74,22,227,37,157,296,269,213,192,293,36,193,293,306,97,18,314,230,236,155,12,300,228,75,174,144,60,299,61,216,292,193,13,78,227,318,34,56,196,102,153,295,256,317,27,252,151,117,111,229,37,258,307,186,17,138,213,144,254,272,66,55,109,148,60,118,135,28,134,
107,135,106,28,177,198,182,311,234,132,198,227,214,180,189,214,173,314,103,299,189,295,190,253,140,312,37,105,22,267,67,266,33,181,273,153,34,177,193,256,141,153,238,278,303,77,103,117,227,277,274,74,295,37,173,158,254,150,136,312,145,23,26,229,220,143,178,262,183,312,276,70,181,193,188,67,238,156,176,189,74,295,53,263,255,300,138,312,261,154,307,77,238,185,35,268,103,25,229,30,13,268,196,52,269,226,268,215,219,101,179,215,77,149,64,292,145,299,112,156,219,298,115,20,273,95,104,16,300,172,18,34,261,38,266,176,149,299,232,53,31,
292,24,112,152,268,21,215,196,57,141,294,92,21,220,57,21,305,96,72,189,30,72,113,15,132,142,19,73,13,16,37,17,151,74,272,307,65,231,297,235,55,224,93,147,216,62,55,76,56,14,227,172,235,144,92,101,308,158,24,70,183,156,154,144,306,312,176,229,55,271,16,52,156,219,34,93,54,219,100,317,72,306,300,145,156,253,229,157,98,231,310,55,146,108,110,310,188,65,114,308,21,214,299,97,21,136,69,227,230,77,110,179,235,301,232,72,143,154,97,212,142,101,179,55,222,182,258,263,55,21,92,144,157,57,141,275,18,35,214,252,69,
97,61,172,68,225,183,108,136,154,267,310,176,151,17,52,35,111,174,197,29,306,252,296,188,118,296,54,314,222,154,75,272,95,228,219,102,253,20,64,222,226,56,181,139,22,114,297,100,156,55,275,188,135,74,172,141,314,14,66,254,229,99,214,106,13,175,115,155,295,228,254,172,27,69,38,173,221,306,216,148,313,219,101,184,117,25,93,178,72,72,140,101,116,267,274,63,186,255,228,156,299,65,64,315,158,274,153,259,180,212,95,64,264,296,268,313,217,198,146,192,306,185,71,225,235,75,118,102,262,195,190,151,278,212,114,302,275,35,214,117,214,
28,33,59,259,294,101,213,135,19,14,173,73,28,301,226,261,112,278,112,103,217,25,255,238,187,137,292,98,304,16,226,156,111,136,140,223,197,190,180,304,63,218,29,260,149,276,26,134,223,314,34,60,72,217,137,71,176,18,182,307,35,148,133,59,74,181,272,278,109,267,100,190,96,177,12,252,100,300,188,224,113,156,144,223,186,271,137,111,298,66,77,190,38,181,277,25,237,177,154,38,144,306,259,188,52,138,180,116,223,95,19,140,303,63,132,297,178,102,272,148,225,27,230,22,15,147,265,295,268,150,67,147,232,75,62,315,27,141,148,32,219,
173,153,311,261,69,305,310,226,267,157,231,223,187,25,303,268,277,180,214,271,174,113,78,309,15,179,213,18,18,186,183,23,234,38,224,66,113,220,180,133,20,318,150,311,60,303,36,314,101,215,300,158,212,310,132,233,316,112,24,22,276,304,156,268,272,16,220,27,255,221,222,134,213,66,221,315,118,57,302,141,146,272,57,298,182,105,231,32,197,75,188,114,177,60,215,102,53,196,67,153,154,185,139,148,231,27,221,252,272,231,225,103,67,317,60,152,58,62,32,26,13,105,107,303,97,62,70,257,181,190,73,150,70,177,213,218,298,183,134,114,292,
93,227,150,145,217,292,151,235,296,21,261,277,136,300,107,195,309,222,234,219,140,176,303,215,150,317,145,69,139,77,143,178,174,71,140,17,265,229,187,59,219,270,272,256,16,196,299,13,315,138,23,309,151,222,72,95,182,33,112,262,263,104,232,93,190,134,65,74,60,156,64,67,148,177,260,146,109,96,56,158,14,96,187,71,141,28,92,294,17,218,224,234,55,307,16,132,70,118,277,255,271,276,59,257,15,107,254,273,31,77,37,175,186,117,134,142,31,274,134,254,29,220,187,254,212,78,226,318,182,255,32,305,254,15,196,19,229,270,270,311,147,
74,224,277,29,221,112,316,146,294,238,75,12,275,193,252,93,188,71,57,95,111,158,101,292,237,237,146,294,64,212,196,214,237,55,183,212,274,258,14,253,310,95,298,261,38,155,263,142,262,37,34,38,141,31,109,230,274,71,225,142,179,147,197,297,14,218,307,267,17,315,19,94,71,38,229,140,260,99,316,37,132,139,97,264,25,299,197,55,141,136,104,92,223,174,24,53,115,55,22,181,93,224,316,318,195,16,152,276,218,315,30,21,174,110,212,217,70,252,55,115,271,186,132,175,226,26,67,95,132,214,298,302,224,14,188,294,67,151,55,34,297,
304,230,191,98,16,31,180,198,154,112,56,37,194,193,300,299,229,147,118,196,66,231,226,150,194,299,310,68,100,294,277,236,254,318,33,313,238,156,265,294,106,183,113,27,197,185,144,256,311,179,35,190,22,180,150,101,172,66,30,254,116,187,181,92,264,113,114,212,25,298,148,224,229,33,179,229,262,25,252,114,292,58,74,143,116,318,66,66,187,69,225,177,271,33,216,315,28,196,116,265,118,178,190,304,193,232,295,222,18,267,278,144,261,113,187,14,293,302,295,307,173,274,306,99,21,155,273,307,193,261,57,107,189,64,31,155,17,190,98,157,180,
275,12,100,304,19,193,263,157,213,68,183,22,93,176,12,295,75,227,156,133,236,37,195,176,292,312,315,213,63,180,173,61,106,214,69,92,111,26,139,147,312,24,109,17,15,314,196,141,78,226,235,55,299,78,143,259,262,317,318,221,20,65,106,173,24,142,259,252,302,29,258,64,215,96,292,133,134,77,313,293,317,94,270,214,30,138,180,97,187,219,112,219,28,141,192,142,316,58,266,156,264,294,269,227,261,254,118,27,111,145,93,141,92,137,19,266,36,35,261,20,111,97,301,136,73,306,107,268,66,303,137,99,22,156,191,25,146,222,154,62,252,
68,153,98,212,108,192,113,72,18,254,53,107,154,233,194,301,257,93,175,27,274,143,143,78,77,300,19,112,70,258,212,261,101,317,140,78,99,230,96,307,21,133,255,65,307,258,18,109,146,177,96,101,175,133,255,54,110,138,36,14,64,313,71,182,216,57,256,136,74,228,92,139,176,36,57,301,187,117,266,173,274,35,276,236,219,256,216,157,148,137,18,72,234,264,142,222,132,105,213,98,314,221,107,191,198,252,59,173,92,260,278,316,16,303,78,64,137,198,23,306,214,29,74,177,37,109,181,116,138,53,298,225,223,141,99,172,110,133,276,28,95,
105,188,237,26,266,255,306,150,313,134,297,146,260,73,136,237,64,27,222,66,274,231,70,312,103,55,32,198,252,97,100,275,96,29,109,253,143,185,273,230,102,236,235,118,297,174,218,65,218,96,198,259,268,300,253,149,100,219,19,13,104,220,178,115,146,97,229,255,69,181,174,278,33,263,134,192,118,157,74,275,212,227,275,55,185,312,23,152,35,225,267,144,310,74,196,99,178,66,303,293,32,256,147,263,70,317,93,68,64,259,308,144,71,74,146,97,298,226,261,191,192,15,53,231,110,236,114,309,262,190,13,62,29,115,66,191,174,255,106,147,154,
60,15,188,214,178,277,59,36,36,154,213,132,138,304,270,150,114,136,308,214,52,172,113,100,313,117,298,65,115,56,263,152,18,36,141,271,257,109,65,143,235,156,64,111,157,233,185,35,300,135,260,312,64,177,212,277,25,92,76,72,178,193,227,158,275,111,217,98,232,52,118,141,184,269,149,255,67,296,233,192,28,297,256,20,69,117,195,152,257,55,238,151,27,305,96,212,156,173,196,55,13,13,92,310,142,194,106,13,221,234,17,300,195,62,173,27,54,275,35,13,15,302,96,277,275,61,212,104,315,310,231,189,302,113,178,302,146,224,307,304,37,
189,22,272,302,74,26,102,263,94,15,225,38,157,110,59,147,35,113,37,104,214,254,292,72,230,28,21,220,95,105,272,96,231,106,184,222,22,310,273,197,108,172,149,186,77,194,75,139,265,267,135,258,172,108,22,186,54,150,213,149,108,269,238,140,67,103,263,62,101,94,294,275,275,13,28,16,223,138,113,28,118,188,293,173,133,176,178,252,312,78,224,271,197,113,61,227,25,32,313,140,31,265,292,138,266,139,236,174,298,309,132,73,235,151,214,175,73,220,106,27,218,147,76,223,32,312,59,28,106,142,183,155,78,216,236,99,194,252,57,17,304,
107,155,38,22,268,52,235,230,259,16,173,36,173,198,111,99,15,270,292,145,133,197,22,109,52,96,218,273,229,57,215,223,117,253,30,173,21,212,144,24,226,266,117,144,230,298,110,113,190,145,262,232,101,146,194,293,311,173,312,30,59,32,294,71,102,19,305,304,309,72,318,94,233,213,103,263,224,237,61,153,154,180,62,53,104,311,75,309,154,140,311,259,297,272,224,52,111,65,318,299,117,261,309,106,316,262,178,75,184,224,301,181,218,21,318,30,106,257,294,93,219,292,238,29,14,95,236,258,53,100,310,236,58,92,220,58,101,17,33,180,36,
108,35,141,74,176,95,13,191,302,273,231,221,34,277,98,237,252,198,20,273,138,24,267,307,22,143,216,76,63,20,52,214,114,30,94,308,55,308,146,16,236,189,92,28,253,233,33,102,270,180,137,149,34,136,35,183,302,305,273,312,55,156,29,36,176,105,102,230,24,145,302,12,307,312,68,154,57,228,75,182,177,102,62,110,145,108,17,23,221,101,173,59,54,118,266,180,310,277,63,61,105,252,172,153,193,262,78,275,54,273,257,198,292,268,149,196,237,134,193,192,136,278,33,23,78,318,102,114,183,185,18,144,229,36,56,61,175,59,147,156,198,
36,117,295,299,260,182,260,308,36,267,69,154,273,137,190,103,294,188,260,213,92,54,312,20,69,52,18,233,99,212,33,97,314,68,219,231,19,195,63,275,272,55,312,263,100,216,219,218,260,148,157,56,179,236,185,193,229,215,156,265,151,188,31,213,67,92,192,22,149,269,97,134,108,318,36,306,106,157,267,34,265,315,238,197,100,15,114,113,103,35,190,76,153,186,175,108,16,177,157,311,305,134,54,185,196,65,197,261,183,292,273,154,268,99,141,72,257,100,151,101,115,149,188,278,116,224,139,156,143,54,138,108,187,185,227,148,191,302,104,178,93,
38,264,53,305,266,63,134,98,30,296,105,113,30,107,300,146,28,292,141,227,30,187,147,218,109,176,64,188,109,313,176,255,144,263,108,216,257,269,152,269,236,190,68,93,74,64,270,65,37,21,270,148,106,181,276,17,218,274,154,118,277,260,307,25,69,60,24,217,175,149,156,62,22,264,29,37,55,153,304,71,295,275,155,20,236,14,175,304,65,27,99,68,190,133,300,15,185,259,222,37,262,23,92,229,60,158,26,118,17,221,63,143,307,134,92,198,76,14,218,74,12,198,224,66,224,257,237,277,92,232,53,299,258,176,14,53,294,265,16,103,261,
272,318,275,213,315,297,296,293,221,187,312,155,151,275,29,196,156,37,58,142,103,268,194,18,38,190,101,237,314,23,220,260,115,59,238,197,75,66,307,132,135,32,114,64,178,94,148,74,15,113,52,21,32,35,188,311,193,17,147,68,12,176,229,314,154,216,101,56,191,174,71,262,295,258,194,306,13,67,66,14,252,74,153,25,139,303,111,107,102,139,24,152,70,21,179,264,14,35,135,228,110,56,234,111,99,296,232,263,19,135,190,64,238,181,269,104,181,151,274,15,138,192,309,58,97,158,178,101,104,183,116,27,33,311,153,235,145,94,221,272,154,
261,24,16,270,217,307,18,92,192,255,313,142,253,54,115,180,218,102,37,308,212,229,179,192,112,253,238,100,235,36,228,238,181,36,76,298,111,57,15,138,261,95,214,299,301,313,76,52,295,217,180,218,273,35,148,172,54,64,26,13,132,151,238,268,222,258,104,191,66,19,65,230,191,305,264,71,182,92,183,71,307,100,181,92,261,185,15,64,25,76,73,307,145,52,215,269,312,186,174,178,175,115,182,314,302,231,104,30,295,195,116,140,276,111,104,301,234,29,137,96,15,307,71,16,154,61,234,229,176,63,312,38,101,76,36,53,220,194,22,222,38,
221,257,61,186,140,309,108,196,276,313,272,13,217,25,151,154,134,258,193,158,92,15,237,146,182,78,275,227,178,37,303,260,189,218,135,138,299,298,57,136,62,138,27,268,188,254,98,258,225,225,180,186,38,191,172,233,17,255,148,224,112,134,156,179,183,306,196,317,71,78,116,103,294,152,92,158,186,58,298,77,235,182,294,257,316,26,114,71,155,158,172,76,236,21,57,274,223,181,95,73,77,34,264,254,54,304,190,300,153,111,295,194,63,71,101,68,70,183,275,27,223,75,38,308,153,296,307,184,312,195,214,31,266,149,214,78,220,74,231,135,143,
198,237,154,237,113,265,221,277,215,31,110,294,114,174,178,28,97,25,134,136,112,139,149,318,17,267,193,265,15,195,267,20,308,180,269,25,268,217,144,300,114,147,224,272,102,30,30,58,92,275,195,76,294,137,14,99,154,180,306,223,133,308,116,31,276,104,299,151,314,65,113,217,220,316,97,15,134,133,265,70,137,304,16,188,298,185,113,274,56,59,302,135,104,181,174,109,115,32,18,301,304,78,74,35,35,224,23,185,108,212,278,30,191,186,17,115,38,212,35,96,102,139,220,293,220,174,223,296,139,252,30,117,157,260,18,57,58,222,310,63,99,
233,112,215,175,69,29,132,182,260,219,264,257,308,152,135,276,227,111,100,212,54,15,136,306,296,190,191,191,212,75,214,216,155,14,307,76,141,221,58,307,177,255,193,268,135,22,61,116,147,196,37,30,238,54,132,273,114,133,137,182,25,135,95,270,117,309,108,217,182,232,266,155,262,134,274,312,315,111,299,56,226,143,134,19,188,72,261,78,191,13,99,69,305,261,216,223,95,35,21,52,153,315,93,25,136,152,232,116,191,17,301,137,261,12,224,141,229,299,236,53,255,218,101,173,144,64,193,196,191,108,16,237,29,138,189,238,176,310,294,312,113,
111,188,174,197,25,14,258,157,275,213,262,74,316,37,238,103,140,34,15,25,312,70,309,187,191,73,300,238,212,15,222,266,177,150,226,179,217,63,187,278,299,13,99,263,317,109,113,54,260,149,278,140,214,225,225,268,264,314,305,140,263,93,185,16,103,223,59,156,259,105,192,299,195,107,77,309,190,264,221,31,26,253,65,106,154,275,96,76,115,265,20,305,114,112,197,271,98,153,316,177,197,223,308,257,311,110,195,64,23,213,190,277,107,110,93,252,70,174,215,217,257,37,17,98,26,116,219,301,299,257,271,227,232,60,238,156,24,292,149,305,108,
213,134,140,222,63,294,184,16,144,53,67,236,75,12,301,98,263,223,223,267,261,189,152,215,267,293,222,254,103,27,31,318,298,301,107,114,143,178,33,23,154,221,145,271,193,136,149,302,233,73,21,62,222,276,278,152,17,221,27,314,254,118,295,143,270,268,181,220,24,214,149,292,111,315,54,14,216,223,59,235,304,262,118,304,93,77,177,228,269,222,172,174,173,261,184,238,183,68,36,294,27,179,266,213,54,297,173,139,116,276,24,173,153,117,149,274,303,226,235,108,53,266,16,221,150,234,308,188,25,76,295,315,193,304,27,136,66,174,180,212,179,
69,274,144,314,302,190,58,226,158,182,152,138,198,195,63,213,138,298,133,181,309,254,178,173,294,52,178,28,117,253,98,152,152,299,21,66,25,118,35,269,149,172,305,312,53,312,25,306,146,224,188,136,100,217,317,78,311,195,215,277,155,265,227,278,157,238,252,17,317,108,62,108,193,182,262,75,309,266,98,238,229,192,62,188,26,13,310,219,150,55,174,299,14,235,26,58,74,29,174,174,229,185,139,296,194,101,17,157,267,33,13,307,31,173,113,271,15,70,237,265,110,78,101,150,155,173,142,218,179,301,112,216,118,275,258,303,215,256,154,172,269,
76,60,19,180,69,59,17,26,62,215,315,71,137,264,255,172,103,189,308,218,198,141,146,278,12,145,136,187,144,136,52,230,293,314,13,225,197,33,110,114,154,216,118,224,307,15,107,186,266,137,254,223,13,142,116,225,265,185,64,27,216,264,277,95,180,23,309,269,140,152,34,256,256,100,212,193,64,312,148,26,231,38,34,115,177,154,68,16,19,272,194,133,64,133,253,261,295,150,265,37,260,117,113,175,68,113,106,265,70,154,142,295,303,142,224,143,312,94,28,102,277,16,198,224,260,62,298,146,63,16,180,152,176,134,15,185,231,309,305,108,260,
137,149,257,235,256,292,213,228,139,94,221,64,138,153,21,269,256,67,258,218,310,269,306,18,115,15,66,215,176,61,175,64,132,65,158,36,276,57,215,152,314,113,187,99,31,266,190,157,139,263,21,114,233,226,19,96,196,212,266,194,22,299,108,300,296,318,151,15,175,12,70,149,99,229,12,118,188,65,275,185,31,29,37,19,214,268,35,132,59,24,153,309,298,62,108,273,315,318,263,263,303,224,12,303,156,132,66,67,35,173,270,100,274,303,311,28,231,108,57,108,37,141,71,257,59,315,182,213,174,314,178,112,15,71,172,188,113,190,255,61,143,
33,112,270,92,139,318,13,55,215,303,59,197,175,18,38,305,312,295,59,153,172,312,36,179,72,173,270,99,229,57,116,92,75,14,146,180,115,75,172,52,60,273,31,220,264,237,27,134,56,258,75,318,105,305,104,33,97,222,228,297,144,229,197,115,238,139,18,215,52,71,221,94,118,182,73,311,64,113,258,69,57,294,178,307,177,75,184,54,234,63,62,52,269,236,60,35,186,138,187,228,18,36,139,197,33,36,157,151,301,303,151,94,71,24,154,102,98,217,272,213,22,26,155,19,27,68,31,237,277,27,307,237,317,147,215,229,140,151,308,23,257,
309,263,154,219,64,273,274,275,238,56,223,151,184,27,148,109,37,54,144,31,58,226,158,154,55,197,13,259,175,146,24,75,145,32,300,70,102,134,145,194,15,76,102,60,269,214,266,298,93,298,305,177,263,32,67,309,136,227,224,54,132,155,235,52,277,133,189,261,196,299,139,110,145,230,93,149,134,94,271,172,298,113,301,229,267,270,238,305,101,234,109,196,301,27,117,272,13,29,102,223,216,72,268,266,17,184,252,63,68,18,115,134,298,94,231,186,115,273,306,104,274,274,302,294,58,66,37,17,24,257,53,304,219,114,115,56,228,305,223,134,68,
193,102,277,117,14,222,215,254,95,98,65,220,67,106,296,267,180,116,113,227,238,34,256,300,67,109,275,31,267,256,276,96,232,28,180,308,19,18,192,97,262,191,107,114,256,229,217,35,115,215,56,108,233,26,234,295,313,71,227,214,308,32,54,60,69,57,275,252,77,23,195,33,27,140,118,102,223,297,265,268,299,302,24,193,65,73,19,270,270,118,260,103,271,191,94,78,53,271,182,255,141,179,258,107,310,309,301,276,318,37,94,54,143,29,309,221,106,114,66,198,293,172,65,313,218,99,134,65,185,222,276,34,228,194,24,234,146,68,109,257,195,
215,30,238,12,297,301,70,189,219,271,175,221,302,15,106,198,262,173,236,310,189,37,223,176,93,144,107,182,313,110,192,135,256,310,108,314,61,273,66,275,184,57,314,174,194,218,315,179,24,266,257,232,304,295,314,57,182,236,158,20,271,278,196,144,194,237,114,309,16,29,317,24,92,176,310,306,37,14,134,264,134,67,14,96,229,225,92,76,77,152,235,222,96,116,277,68,306,38,311,150,278,230,64,70,15,298,268,28,223,17,271,58,20,269,65,256,234,150,258,236,69,215,110,138,92,299,188,141,34,52,309,56,110,238,36,62,238,107,110,198,104,
132,35,29,299,309,175,52,142,267,75,263,145,29,70,302,293,309,296,75,116,109,110,278,274,99,259,94,112,116,14,117,106,67,70,307,305,142,273,147,31,66,314,110,20,233,275,181,69,19,102,29,63,21,136,176,110,223,267,198,298,224,194,23,233,13,32,99,315,227,303,315,277,259,219,237,32,19,192,183,302,273,254,78,183,308,253,19,193,298,146,71,152,134,271,270,298,308,215,94,14,187,308,212,256,236,108,254,106,95,157,78,28,29,217,113,174,13,179,54,141,264,145,33,219,137,197,132,57,276,293,272,55,30,253,189,260,253,305,212,276,144,
266,197,233,36,220,229,305,272,228,278,64,98,118,266,156,144,261,309,98,60,134,276,305,96,96,318,157,261,175,134,75,267,27,232,174,74,255,135,110,19,98,52,32,194,187,141,262,193,278,143,230,232,295,36,314,234,314,68,309,308,110,112,92,213,93,221,217,75,314,173,16,253,78,225,148,262,71,229,300,174,150,70,259,144,313,100,257,32,118,37,150,235,307,94,184,262,148,186,70,35,65,17,101,12,103,67,111,62,30,233,196,54,141,108,256,235,235,148,238,157,97,182,38,13,144,136,19,61,222,72,269,297,190,67,296,273,172,273,236,238,101,
149,177,172,238,186,227,155,64,31,28,153,147,52,192,94,29,152,22,266,68,215,180,236,61,312,109,237,261,230,269,133,233,93,158,33,14,303,307,95,111,221,76,21,275,22,53,64,153,234,300,260,183,272,13,269,305,233,229,105,143,261,217,75,264,73,224,215,276,24,254,314,302,188,16,317,259,273,178,38,181,182,306,154,255,74,180,70,193,64,113,254,13,187,28,136,53,60,198,147,310,267,135,118,25,316,215,105,115,176,23,315,154,301,305,191,300,216,158,267,105,135,75,61,263,192,236,57,225,113,17,138,111,113,235,154,195,173,71,12,182,65,
212,26,15,187,31,136,179,181,183,134,194,68,23,268,64,36,102,302,23,135,235,108,54,180,107,263,310,76,213,222,105,76,155,269,109,292,52,235,276,263,311,93,212,178,252,67,142,132,311,76,316,226,223,29,184,311,222,263,268,33,143,12,296,116,309,262,53,105,101,17,232,184,133,266,180,61,265,254,212,186,256,101,37,103,30,112,65,97,134,306,12,219,301,74,316,261,111,97,214,174,95,146,97,277,312,267,116,25,300,229,294,186,300,98,72,156,317,19,20,263,258,75,215,306,304,14,182,172,193,75,227,262,70,256,212,227,134,186,22,35,65,
278,267,274,230,66,52,292,221,59,103,193,24,278,292,265,252,180,73,13,70,263,233,12,156,315,143,277,76,112,259,155,18,146,185,173,260,267,18,304,132,36,214,293,71,192,181,188,15,298,75,270,262,295,117,149,277,27,54,223,311,26,135,36,295,254,72,138,72,219,278,258,185,260,12,236,223,217,188,133,278,137,188,56,15,254,141,20,258,233,187,187,151,293,253,115,305,212,185,185,190,268,174,198,277,142,229,259,173,157,230,106,76,62,98,107,293,132,16,317,214,224,179,93,301,258,301,52,263,100,277,311,69,52,70,13,194,314,118,152,258,229,
229,59,254,236,304,73,253,191,224,222,113,216,198,67,118,151,18,182,57,262,181,173,68,68,116,227,28,226,186,146,95,237,137,177,298,140,254,103,35,95,317,58,216,174,67,233,116,275,262,31,147,65,308,75,192,157,184,302,237,268,258,304,180,27,92,135,176,217,15,234,266,57,152,138,275,55,153,197,16,153,36,153,194,188,62,95,307,55,232,114,152,62,16,116,18,109,68,214,173,134,157,299,17,54,101,118,197,183,37,218,237,178,304,252,195,273,12,13,111,232,179,298,115,265,103,135,302,188,97,110,309,175,22,145,299,100,196,315,300,223,33,
14,23,93,300,228,297,109,144,116,20,150,318,99,93,217,301,28,108,304,36,183,133,95,94,236,55,315,95,60,196,268,293,116,114,304,214,147,216,256,299,99,260,55,60,267,52,232,265,196,105,77,260,271,314,114,185,175,318,18,277,298,115,13,227,96,106,110,263,144,52,196,53,63,180,30,60,308,21,108,172,101,139,252,226,264,235,63,303,310,306,269,133,230,176,138,233,26,257,140,133,214,136,253,293,74,63,306,258,234,312,222,62,52,216,226,147,218,217,303,103,214,156,38,133,195,107,301,18,154,29,118,196,112,184,111,93,303,254,278,67,310,
274,317,59,217,186,225,157,197,267,98,185,227,262,257,108,101,309,278,33,53,184,100,138,58,213,72,183,142,276,66,275,198,63,99,53,61,264,181,292,135,56,317,272,190,156,136,292,73,221,35,258,104,109,300,55,314,143,71,228,175,25,30,271,34,146,238,307,76,16,76,103,154,182,262,78,77,138,315,212,195,269,215,238,143,152,213,149,146,252,33,92,38,37,158,192,145,215,310,100,256,157,106,195,235,76,305,150,256,262,96,174,153,136,294,312,216,62,190,299,226,302,231,191,294,259,30,268,305,301,117,184,300,278,77,227,33,315,113,226,20,115,
296,311,135,151,68,103,98,20,96,307,78,62,23,60,217,185,16,259,220,229,309,67,238,147,140,307,305,135,13,293,140,35,266,254,24,139,134,144,98,268,145,309,225,261,29,74,95,67,309,37,31,231,32,70,263,92,52,151,296,109,192,299,277,302,305,225,149,191,134,185,232,26,63,67,106,298,64,140,178,136,184,266,258,108,145,226,260,66,20,185,158,21,198,276,109,278,98,147,226,28,135,261,183,218,141,225,26,226,145,56,197,102,273,310,271,277,62,295,226,311,256,197,177,299,103,172,12,305,301,94,219,267,102,67,270,262,16,110,259,312,258,
77,69,99,294,103,263,63,232,230,116,145,71,72,257,181,143,98,99,55,106,216,236,117,301,262,152,188,59,292,257,153,153,143,72,315,104,135,118,219,105,294,306,19,99,19,151,22,265,186,100,152,194,145,99,143,98,59,140,313,295,175,117,225,12,311,68,16,269,314,152,217,233,234,275,149,278,194,35,150,36,183,225,234,183,314,70,229,303,145,92,233,185,57,59,148,110,229,117,232,150,218,70,133,255,256,297,234,269,191,185,267,144,112,266,27,29,92,53,76,255,271,35,217,27,316,185,232,27,185,178,297,53,313,233,307,213,174,141,225,34,116,
110,313,212,269,318,213,196,154,102,38,36,153,22,187,156,216,177,30,314,215,261,137,296,17,223,186,238,28,318,274,179,56,36,113,309,180,23,267,107,157,68,229,58,224,29,28,37,188,94,224,95,195,111,276,183,252,56,219,196,214,304,236,173,300,21,158,236,292,74,218,56,114,176,143,28,305,55,230,278,158,307,188,190,231,104,228,273,267,268,95,145,220,135,111,155,56,156,102,227,309,77,223,316,272,188,54,141,310,139,156,303,93,102,266,214,270,219,308,146,37,139,136,172,308,274,185,13,316,13,28,35,147,53,143,253,308,36,26,178,262,13,
261,192,315,228,30,56,217,191,258,194,151,57,278,265,315,158,223,65,30,94,183,156,37,198,105,12,229,212,117,299,73,221,306,188,293,312,318,293,33,16,215,192,270,271,94,194,18,115,278,110,257,20,95,92,271,223,76,269,298,107,315,107,238,302,77,76,221,157,277,27,134,95,259,144,77,252,78,221,114,97,115,224,313,151,222,266,38,118,273,315,264,315,156,197,311,265,154,148,154,19,317,154,277,115,54,55,255,105,181,148,268,118,150,72,146,178,253,64,275,17,77,185,107,150,277,302,311,97,213,138,295,264,96,305,35,64,298,235,143,55,107,
20,96,34,213,115,31,34,136,253,100,132,314,73,111,103,18,140,94,54,258,174,173,222,104,132,314,29,276,78,146,175,308,216,27,217,75,14,146,143,134,114,93,313,183,234,14,215,219,100,180,111,315,114,253,302,315,20,157,253,63,140,109,153,107,67,312,268,76,73,303,257,300,33,179,53,258,38,100,146,313,238,115,174,38,52,309,270,218,55,218,255,228,19,55,75,293,150,273,96,218,259,214,96,13,303,78,31,212,67,12,136,24,97,219,228,29,315,238,61,139,307,311,299,117,292,25,266,273,231,312,101,140,12,215,298,223,313,76,233,99,317,
33,53,35,175,14,157,212,100,226,179,54,68,180,113,215,32,253,135,12,175,265,254,197,212,146,38,183,297,32,238,224,147,35,182,178,309,256,292,299,108,223,142,301,133,213,134,267,154,294,138,224,75,95,157,38,270,236,72,229,77,269,153,77,179,195,179,187,318,61,274,296,229,133,14,236,233,198,77,306,138,294,229,146,316,213,255,277,226,22,260,69,271,295,137,67,259,113,106,98,255,318,25,274,141,234,267,55,20,30,173,20,20,212,37,139,21,31,20,313,174,156,273,16,26,67,144,262,18,139,215,265,145,64,177,156,226,184,151,215,99,107,
29,193,269,150,157,27,96,190,301,113,97,76,293,96,181,299,267,108,155,264,311,153,214,116,270,31,278,57,187,309,186,183,118,315,187,117,175,196,177,95,99,93,23,56,66,25,117,183,37,143,227,298,54,277,57,274,225,25,232,152,236,256,58,16,173,67,96,302,107,64,148,317,263,151,74,19,112,78,262,105,233,22,113,99,185,261,274,255,65,227,94,52,15,116,21,104,254,92,69,58,197,309,303,155,183,237,188,311,97,132,111,57,266,20,158,260,305,150,148,32,133,301,186,174,238,230,93,17,32,133,292,100,116,182,32,273,148,69,25,306,24,
256,116,180,307,154,107,180,22,135,151,300,52,217,56,263,259,145,179,276,146,276,97,316,65,217,234,230,98,151,54,178,118,23,116,18,309,137,228,198,112,220,196,107,298,14,318,184,134,71,73,63,232,114,313,142,13,184,310,304,306,191,308,272,12,193,213,141,229,238,252,226,31,149,98,298,233,13,297,187,253,195,134,13,109,195,315,186,270,106,63,14,26,213,109,294,66,78,56,309,99,58,299,307,70,132,157,221,175,198,313,16,263,223,190,94,58,223,93,66,193,307,196,313,252,254,156,316,145,14,22,118,229,21,301,106,227,315,26,278,192,238,
307,77,213,149,237,234,172,100,30,29,223,178,148,314,23,149,265,219,178,133,182,223,133,13,272,261,97,38,295,221,34,94,21,264,258,292,274,198,315,300,94,143,76,218,62,102,132,318,195,260,12,316,59,182,195,292,118,273,277,185,213,57,252,59,258,234,31,266,52,272,18,67,134,109,313,214,103,92,253,55,99,213,64,179,140,92,300,306,73,273,25,104,148,264,12,105,296,263,96,100,181,104,301,15,69,191,297,150,267,299,12,147,74,102,306,52,117,314,185,18,67,228,65,104,14,177,221,307,174,77,214,97,76,100,135,223,257,115,137,14,214,
223,98,310,253,194,305,37,309,138,93,132,194,192,270,72,198,232,172,23,17,252,92,142,30,220,231,56,266,312,72,109,98,13,313,271,229,261,256,67,69,145,261,153,35,76,101,156,92,78,265,221,156,268,14,99,258,254,103,32,197,118,18,140,15,308,254,182,307,225,217,27,149,20,306,155,63,186,309,229,114,237,237,224,270,268,106,175,307,76,33,196,103,18,233,67,220,118,31,17,173,71,192,306,238,139,194,176,298,266,266,60,227,34,172,315,14,308,15,67,175,254,255,184,108,33,23,217,294,74,221,100,188,103,118,222,22,132,213,230,97,315,
259,137,22,97,145,198,140,155,216,61,33,33,318,297,181,238,225,32,28,217,12,139,28,105,304,269,221,317,12,105,272,225,74,271,150,186,52,18,175,183,177,36,77,137,260,271,112,17,252,314,27,56,257,154,191,67,13,53,24,226,188,266,177,21,67,107,147,237,58,232,252,154,66,103,27,310,35,54,136,236,316,101,96,23,52,295,293,178,195,141,255,20,293,57,99,76,235,306,15,187,93,139,141,141,229,230,305,155,274,308,18,175,25,115,189,95,103,95,293,151,115,142,292,14,95,173,67,34,259,193,104,102,221,133,72,142,317,158,191,12,32,
237,18,185,16,265,215,300,260,139,103,218,198,73,189,311,116,184,32,236,104,101,147,212,23,141,183,262,112,263,23,257,62,273,224,95,295,266,113,187,66,107,220,142,18,300,267,277,227,231,198,104,104,135,212,262,301,105,145,188,196,262,181,109,134,69,75,36,96,100,154,186,258,223,110,158,95,136,263,113,74,176,147,174,103,140,308,265,138,94,306,60,12,300,111,258,178,303,230,12,24,34,14,217,141,175,312,259,114,175,226,19,65,103,231,136,76,108,53,154,150,147,25,188,220,108,149,100,192,267,305,21,118,101,75,16,55,318,259,192,304,95,
234,54,257,229,254,31,18,25,266,314,177,103,24,147,174,310,92,306,178,265,215,29,182,262,34,59,177,61,265,95,256,70,190,300,57,94,256,25,183,299,147,179,31,35,262,96,100,98,32,108,68,36,187,15,198,138,109,150,294,233,297,189,275,179,136,52,57,178,174,154,98,188,109,220,187,186,183,29,262,278,155,198,302,195,197,63,150,93,118,233,254,225,185,301,254,116,156,218,293,141,30,95,144,302,212,132,17,35,105,132,230,109,105,218,301,57,256,77,30,151,52,74,27,33,227,198,23,273,217,196,134,30,157,230,269,20,149,270,134,193,78,
297,230,74,268,276,190,186,212,312,35,295,212,98,253,18,141,74,181,30,267,103,144,215,144,312,300,59,196,213,228,309,194,133,260,148,292,183,93,152,101,307,317,172,259,298,155,294,68,258,14,233,296,262,277,317,213,115,255,98,29,29,214,58,231,151,268,223,70,37,230,104,132,270,21,133,15,139,307,21,270,192,307,238,197,137,96,235,55,293,97,20,106,23,311,100,69,27,253,252,158,57,177,106,97,197,113,133,188,303,118,143,139,98,99,29,216,150,307,19,226,317,184,150,154,136,189,112,26,108,268,272,265,56,37,117,270,65,260,192,132,136,
263,67,318,196,266,234,198,62,13,108,97,180,23,179,132,65,152,259,36,261,61,234,65,254,144,308,67,198,270,140,17,141,293,70,116,225,59,217,318,113,196,314,142,94,293,263,65,236,36,212,117,55,155,277,136,276,34,227,312,276,25,258,77,297,99,154,265,223,133,25,107,152,144,17,16,75,301,215,314,175,146,98,108,65,252,198,37,114,177,94,233,212,314,95,306,113,309,225,191,230,148,190,157,213,315,174,78,157,293,309,264,219,141,177,17,182,233,55,30,144,26,307,150,142,113,254,113,177,213,58,189,271,78,133,133,296,218,158,274,256,310,
317,149,305,302,69,217,277,192,36,96,103,34,111,54,267,314,69,92,72,294,183,178,253,62,17,21,107,252,278,235,267,173,231,151,314,56,112,217,141,16,252,117,261,132,33,178,221,76,185,189,70,57,135,188,316,256,196,274,292,235,96,186,158,198,277,17,58,188,29,268,137,57,109,36,267,30,173,114,56,99,260,261,292,318,94,65,303,216,61,254,195,109,34,111,33,309,145,55,214,302,97,72,266,38,102,193,64,34,306,144,60,104,297,22,152,105,95,141,264,267,309,31,38,268,71,30,256,318,135,278,104,148,53,197,138,186,78,293,65,103,32,
112,140,63,218,189,157,175,151,149,217,216,273,231,26,183,302,29,20,72,62,55,178,306,258,14,294,158,111,158,197,220,198,27,310,232,68,29,73,71,109,61,135,269,12,188,259,196,265,13,73,217,313,218,132,28,25,226,155,66,15,313,229,238,268,177,304,178,146,292,198,310,56,315,310,152,158,20,134,235,255,96,114,17,293,67,190,195,270,238,75,33,111,176,58,98,262,261,96,212,139,26,192,142,295,222,57,238,269,60,317,38,314,272,115,58,55,133,212,142,311,102,26,14,24,112,23,234,142,276,95,64,98,212,24,22,231,153,66,177,75,262,
270,297,308,197,28,35,15,101,214,104,277,214,93,260,133,30,31,258,297,68,17,36,298,189,145,153,38,298,93,65,14,294,104,304,238,67,185,140,97,194,106,173,269,270,216,308,232,225,264,296,198,35,110,276,29,275,150,139,28,305,173,138,183,34,186,198,172,197,254,292,194,34,306,193,307,273,38,138,184,261,261,106,269,26,302,107,293,270,307,260,262,75,158,224,275,99,221,265,147,157,314,184,22,266,176,137,197,232,236,179,229,142,38,227,190,114,310,132,111,192,303,138,100,306,311,216,53,187,118,184,118,22,33,141,221,273,63,66,110,195,113,
98,276,32,111,36,97,231,152,77,13,72,309,24,24,264,177,145,260,55,36,56,214,188,299,219,136,149,13,132,311,113,198,93,310,255,292,111,277,76,148,278,226,147,96,227,29,272,174,183,145,116,74,305,233,92,13,67,217,237,22,94,179,15,220,293,116,152,268,305,236,117,260,180,255,274,27,317,223,183,33,29,310,223,318,223,219,311,275,113,22,146,257,53,136,38,267,182,21,306,215,294,309,304,93,104,174,109,68,275,301,23,34,309,54,172,109,116,182,233,101,21,97,295,156,141,108,92,293,316,33,115,261,145,186,33,19,52,234,299,228,178,
228,115,59,277,264,313,28,236,65,272,115,34,93,72,106,314,57,114,145,221,237,107,225,277,151,196,132,30,108,101,102,225,75,308,227,64,196,183,13,31,190,25,143,136,262,146,58,154,303,140,14,253,221,108,95,61,23,261,178,276,54,95,318,309,112,229,195,92,16,23,214,257,274,195,19,236,132,232,237,183,216,12,178,24,253,184,30,134,313,318,307,316,179,309,221,14,17,197,315,32,54,116,227,266,220,190,108,299,257,305,19,62,144,142,276,189,65,36,176,150,53,304,114,134,105,28,225,132,63,187,138,157,313,141,24,16,155,297,70,12,78,
306,98,315,235,316,145,307,294,300,224,64,235,213,273,28,38,97,294,116,71,259,133,228,102,152,146,156,262,69,31,277,198,74,55,275,311,219,20,96,59,275,313,188,312,261,29,62,304,67,194,38,69,317,113,92,147,196,138,97,58,156,219,216,155,296,252,215,33,100,105,96,152,138,15,71,158,97,74,21,62,293,59,117,175,181,115,298,35,255,271,296,26,158,225,298,12,315,312,139,20,38,145,272,224,188,31,310,67,17,99,265,198,183,33,295,147,190,235,216,63,64,237,59,235,76,73,140,181,158,219,55,316,271,59,311,307,145,276,295,305,25,
258,254,264,78,317,106,54,301,151,23,145,318,255,253,24,54,140,116,277,134,175,301,118,218,232,62,304,266,238,213,135,275,213,186,147,235,237,12,62,149,185,261,176,304,309,261,32,232,218,36,296,142,66,27,307,177,32,196,177,19,222,197,54,97,132,144,108,138,100,217,177,262,235,14,36,195,70,274,216,100,53,150,230,52,77,153,96,217,60,312,77,66,182,19,254,95,13,197,108,136,312,13,52,30,265,264,15,216,276,296,274,32,21,153,72,232,260,16,139,98,277,60,229,140,22,68,217,17,192,258,141,238,215,109,74,72,65,296,153,92,195,
54,55,146,111,276,112,27,265,12,93,153,180,136,303,237,236,197,254,19,296,230,255,196,98,218,34,234,112,224,215,136,178,26,97,181,223,93,116,316,54,152,107,64,67,237,52,179,38,138,27,212,254,140,296,262,237,305,78,213,149,313,104,147,63,101,314,70,93,271,259,315,310,220,294,221,72,52,92,268,13,108,72,142,154,305,18,232,297,116,183,304,237,13,57,95,263,12,293,54,72,148,309,313,307,188,52,308,278,30,59,179,197,54,96,76,268,295,105,107,19,293,37,145,259,303,108,24,158,66,132,270,64,13,172,104,94,24,55,312,274,116,
182,102,31,71,58,307,98,272,183,53,13,53,28,254,236,24,270,312,266,70,176,152,275,217,198,237,264,303,292,72,16,189,155,265,238,187,65,318,197,111,140,151,233,294,227,311,265,198,96,73,174,23,96,35,238,32,106,52,225,269,146,195,318,173,252,292,230,102,16,141,146,213,52,197,35,101,139,256,223,94,14,220,116,308,153,190,266,255,104,96,268,271,183,23,60,105,307,306,102,132,178,62,310,38,301,269,28,75,34,60,132,58,258,153,303,147,274,300,297,16,315,259,60,318,13,223,219,219,216,224,104,262,17,102,298,152,184,23,296,225,268,
133,274,104,187,222,15,180,274,172,135,152,224,100,26,260,76,59,31,173,53,227,93,132,25,25,178,273,36,257,221,18,238,54,69,316,195,272,219,136,181,26,235,12,215,184,140,56,312,261,63,299,217,141,98,53,146,24,221,266,181,110,133,303,28,260,112,68,213,154,102,148,185,214,318,192,295,212,258,25,54,269,192,137,221,117,221,222,109,274,98,22,294,64,272,306,98,172,69,16,254,217,217,218,264,229,23,274,193,230,137,112,278,157,62,309,112,93,149,302,297,78,143,195,307,176,252,259,192,54,278,190,32,222,302,16,33,304,97,305,104,191,
310,174,20,22,198,114,69,108,185,104,36,114,296,296,192,74,13,133,226,306,144,215,308,258,140,177,154,60,182,149,17,28,232,316,99,310,68,253,22,316,20,56,137,149,23,175,231,265,57,184,293,195,35,69,316,19,139,259,36,238,229,264,132,29,144,21,261,213,38,228,145,301,234,14,139,221,192,275,141,108,255,301,300,214,114,226,237,73,21,179,219,315,266,106,314,105,56,294,174,54,292,13,19,148,185,301,312,23,136,256,294,187,296,236,235,36,54,63,178,138,133,303,118,225,227,20,187,221,304,213,192,216,22,275,64,191,236,316,317,153,215,
58,108,16,298,54,173,293,297,96,35,177,268,95,12,185,139,228,156,58,74,217,233,136,278,189,77,63,59,274,231,134,37,145,224,176,66,197,197,158,36,237,29,104,100,140,175,76,63,271,135,224,19,107,106,186,38,105,252,139,137,260,33,195,301,235,218,74,265,238,55,173,226,70,261,155,151,151,29,299,186,175,197,216,228,62,62,34,108,293,258,215,234,76,255,22,32,25,66,256,271,
152,151,198,260,64,103,295,59,148,134,198,218,252,226,105,100,69,76,277,187,155,71,260,53,15,309,67,191,176,54,238,63,310,143,114,146,92,192,309,173,138
	};

bool Game_Init(HWND window)
{
	Direct3D_Init(window, SCREENW, SCREENH, false);
	DirectInput_Init(window);

	//create pointer to the backbuffer
	d3ddev->GetBackBuffer(0, 0, D3DBACKBUFFER_TYPE_MONO, &backbuffer);

	//load the tile images
	tiles = LoadSurface("map.bmp");

	if (!tiles)
		return false;

	//create the scroll buffer surface in memory, slightly bigger 
    //than the screen
    const int SCROLLBUFFERWIDTH = SCREENW + TILEWIDTH * 3;
    const int SCROLLBUFFERHEIGHT = SCREENH + TILEHEIGHT * 3;

	HRESULT result = d3ddev->CreateOffscreenPlainSurface(
		SCROLLBUFFERWIDTH, SCROLLBUFFERHEIGHT, 
		D3DFMT_X8R8G8B8, D3DPOOL_DEFAULT,
		&scrollbuffer, 
		NULL);
    if (result != S_OK) return false;

	start = GetTickCount();

    return true;
}

//This function updates the scrolling position and speed
void UpdateScrollPosition()
{
    const int GAMEWORLDWIDTH = TILEWIDTH * MAPWIDTH;
    const int GAMEWORLDHEIGHT = TILEHEIGHT * MAPHEIGHT;

    //update horizontal scrolling position and speed
    ScrollX += SpeedX;

    if (ScrollX < 0) 
	{
        ScrollX = 0;
        SpeedX = 0;
	}
    else if (ScrollX > GAMEWORLDWIDTH - WINDOWWIDTH)
	{
        ScrollX = GAMEWORLDWIDTH - WINDOWWIDTH;
        SpeedX = 0;
	}
    
    //update vertical scrolling position and speed
    ScrollY += SpeedY;
    if (ScrollY < 0)
	{
        ScrollY = 0;
        SpeedY = 0;
	}
	else if (ScrollY > GAMEWORLDHEIGHT - WINDOWHEIGHT)
	{
        ScrollY = GAMEWORLDHEIGHT - WINDOWHEIGHT;
        SpeedY = 0;
    }
}

//This function does the real work of drawing a single tile from the 
//source image onto the tile scroll buffer. Parameters provide much 
//flexibility.
void DrawTile(LPDIRECT3DSURFACE9 source,	// source surface image
				int tilenum,				// tile #
				int width,					// tile width
				int height,					// tile height
				int columns,				// columns of tiles
				LPDIRECT3DSURFACE9 dest,	// destination surface
				int destx,					// destination x
				int desty)					// destination y
{
    
    //create a RECT to describe the source image
    RECT r1;
    r1.left = (tilenum % columns) * width;
    r1.top = (tilenum / columns) * height;
    r1.right = r1.left + width;
    r1.bottom = r1.top + height;
    
    //set destination rect
	RECT r2 = {destx,desty,destx+width,desty+height};
    
    //draw the tile 
    d3ddev->StretchRect(source, &r1, dest, &r2, D3DTEXF_NONE);
}



//This function fills the tilebuffer with tiles representing
//the current scroll display based on scrollx/scrolly.
void DrawTiles()
{
    int tilex, tiley;
    int columns, rows;
    int x, y;
    int tilenum;
    
    //calculate starting tile position
    tilex = ScrollX / TILEWIDTH;
    tiley = ScrollY / TILEHEIGHT;
    
    //calculate the number of columns and rows
    columns = WINDOWWIDTH / TILEWIDTH;
    rows = WINDOWHEIGHT / TILEHEIGHT;
    
    //draw tiles onto the scroll buffer surface
    for (y=0; y<=rows; y++)
	{
        for (x=0; x<=columns; x++)
		{
			//retrieve the tile number from this position
            tilenum = MAPDATA[((tiley + y) * MAPWIDTH + (tilex + x))];

			//draw the tile onto the scroll buffer
            DrawTile(tiles,tilenum,TILEWIDTH,TILEHEIGHT,16,scrollbuffer,
                x*TILEWIDTH,y*TILEHEIGHT);
		}
	}
}

//This function draws the portion of the scroll buffer onto the back buffer
//according to the current "partial tile" scroll position.
void DrawScrollWindow(bool scaled = false)
{
    //calculate the partial sub-tile lines to draw using modulus
    int partialx = ScrollX % TILEWIDTH;
    int partialy = ScrollY % TILEHEIGHT;
    
    //set dimensions of the source image as a rectangle
	RECT r1 = {partialx,partialy,partialx+WINDOWWIDTH-1,partialy+WINDOWHEIGHT-1};
        
    //set the destination rectangle
    RECT r2;
    if (scaled) {
        //use this line for scaled display
	    RECT r = {0, 0, WINDOWWIDTH-1, WINDOWHEIGHT-1};  
        r2 = r;
    }
    else {
        //use this line for non-scaled display
        RECT r = {0, 0, SCREENW-1, SCREENH-1};
        r2 = r;
    }

    //draw the "partial tile" scroll window onto the back buffer
    d3ddev->StretchRect(scrollbuffer, &r1, backbuffer, &r2, D3DTEXF_NONE);
}


void Game_Run(HWND window)
{
    if (!d3ddev) return;
    DirectInput_Update();
    d3ddev->Clear(0, NULL, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, D3DCOLOR_XRGB(0,0,100), 1.0f, 0);

	//scroll based on key input
	if(Key_Down(DIK_UP))
	{
		ScrollY += 1;
	}

	if(Key_Down(DIK_DOWN))
		ScrollY -= 1;

    //keep the game running at a steady frame rate
    if (GetTickCount() - start >= 30)
    {
        //reset timing
        start = GetTickCount();

		//update the scrolling view
		UpdateScrollPosition();

		//start rendering
		if (d3ddev->BeginScene())
		{
			
			//draw tiles onto the scroll buffer
			DrawTiles();

			//draw the scroll window onto the back buffer
			DrawScrollWindow();


            spriteobj->Begin(D3DXSPRITE_ALPHABLEND);
   
            spriteobj->End();

			//stop rendering
			d3ddev->EndScene();
            d3ddev->Present(NULL, NULL, NULL, NULL);
		}
	}

    //to exit 
    if (KEY_DOWN(VK_ESCAPE))
        gameover = true;

}

void Game_End()
{
    if (scrollbuffer) scrollbuffer->Release();
    if (tiles) tiles->Release();
    DirectInput_Shutdown();
    Direct3D_Shutdown();
}